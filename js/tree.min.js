var w=900;var h=300;var textMargins={top:20,left:0,bottom:70,right:0};var color=d3.scaleOrdinal(d3.schemeCategory10);var svg=d3.select(".svg-canvas");d3.json("data/Matches-Mencius-ZGZY.json",function(b,c){var m={};var i=svg.append("g").classed("text-holder",true);i.selectAll("rect").data(c.texts).enter().append("rect").attr("x",0).attr("y",function(o,n){return(n>0)?h-textMargins.bottom:textMargins.top}).attr("width",w).attr("height",50);i.selectAll("texts").data(c.texts).enter().append("text").attr("x",0).attr("y",function(o,n){return(n>0)?h-5:15}).text(function(n){m[n.name]=n.textLength;return n.name+" : "+n.textLength+" characters"});var l=svg.append("g").classed("node-holder",true);l.selectAll("rect").data(c.nodes).enter().append("rect").attr("y",function(n){return(n.group==0)?h-70:20}).attr("x",function(n){return(n.index/m[(n.group==0)?"Mencius":"ZGZY"])*w}).attr("width",function(n){return f(n.l,n.group)}).attr("height",50);var a=svg.append("g").classed("link-holder",true);a.selectAll("path").data(c.links).enter().append("path").attr("stroke-width",function(n){f(n.l,0)}).attr("d",function(n){return e(c,n.source,n.target)});function e(q,p,o){var n="M "+k(q,p)+","+j(q,p);n+=" C "+k(q,p)+","+h/2;n+=" "+k(q,o)+","+h/2;n+=" "+k(q,o)+","+j(q,o);return n}function g(p,q){var o=0;var n;do{n=p.nodes[o];o++}while(n.id!=q);if(n.id==q){return n}}function k(n,o){d=g(n,o);return(d.index/m[(d.group==0)?"Mencius":"ZGZY"])*w}function j(n,o){d=g(n,o);return(d.group!=0)?70:h-70}function f(o,p){var n=(o/m[(p==0)?"Mencius":"ZGZY"])*w;return Math.max(1,n)}});